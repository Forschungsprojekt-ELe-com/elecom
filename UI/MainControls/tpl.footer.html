<!-- BEGIN footer_perm_url -->
<div class="il-footer-permanent-url">
	<div class="pulseButton" style="width: fit-content;margin: auto;" onclick="selectPermalink();">{PERMANENT} <span class="glyphicon glyphicon-link"></span></div>
	<input id="current_perma_link" type="text" value="{PERMANENT_URL}" readonly="readonly" />
</div>
<!-- END footer_perm_url -->
<div class="il-maincontrols-footer">
	<div class="il-footer-content">
		<div class="il-footer-text">
			{TEXT}
		</div>
		<!-- BEGIN footer_links -->
		<div class="il-footer-links">
			{LINKS}
		</div>
		<!-- END footer_links -->
	</div>
	<!-- BEGIN footer_modals -->
	<div class="il-footer-modals">{MODALS}</div>
	<!-- END footer_modals -->
</div>

<script>
	document.addEventListener("DOMContentLoaded", function () {
		if ($("#current_perma_link").length) {
			let href = $(".il-footer-permanent-url .pulseButton > a").attr("href");
			$("#current_perma_link").val(href);
			var input_size = Math.min(Math.floor((screen.width - 37) / 6) - 1, $("#current_perma_link").val().length);
			$("#current_perma_link").attr("size", input_size);
		}
	}, false);
	function selectPermalink() {
		var input = document.getElementById('current_perma_link');
		var isiOSDevice = navigator.userAgent.match(/ipad|iphone/i);
		if (isiOSDevice) {
			input.contentEditable = true;
			input.readOnly = false;
			var range = document.createRange();
			range.selectNodeContents(input);
			var selection = window.getSelection();
			selection.removeAllRanges();
			selection.addRange(range);
			input.setSelectionRange(0, 999999);
			input.contentEditable = false;
			input.readOnly = true;
			document.execCommand('copy');
		} else {
			input.select();
			input.setSelectionRange(0, 99999);
			navigator.clipboard.writeText(input.value);
		}
	}
</script>
